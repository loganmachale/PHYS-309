import numpy as np
from scipy.interpolate import Rbf
from scipy.interpolate import splrep, splev

V_1 = 50E-3
cR_1 = 120.26E3
cf_arr = np.array([1, 2, 3, 6, 10, 18, 32, 56, 100, 178, 316, 562, 1000, 1.778E3,
                   3.162E3, 5.623E3, 1E4, 1.7783E4, 3.1623E4, 5.6234E4, 1E5])

def v_into_amp(V_in, R_1, R_2):
    return V_in * R_2 / (R_1 + R_2)


cR_2 = np.array([982.4, 982.4, 391.017, 391.017, 200.64, 150.241, 150.241, 120.543, 120.543,
                 120.543, 120.543, 120.543, 120.543, 120.543, 120.543, 120.543, 120.543,
                 120.543, 325.049, 392.225, 980.54])
obs_V_out = np.array([0.0271104, 0.0619515, 0.0470196, 0.1201965, 0.099546, 0.109077,
                      0.1318455, 0.1149015, 0.120726, 0.118608, 0.1180785, 0.11649,
                      0.11649, 0.115431, 0.1117245, 0.1011345, 0.0810135, 0.0534795,
                      0.083661, 0.0481845, 0.04897875]
)

V_in = v_into_amp(V_1, cR_1, cR_2)

obs_G = obs_V_out / V_in

spl = splrep(cf_arr, obs_G, k=3)

def G_cal_coeff(f):
     return splev(f, spl)